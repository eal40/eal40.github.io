/* Performance Optimization Styles */

/* Lazy Loading States */
.lazy-loading {
    opacity: 0.7;
    background-color: #f0f0f0;
    background-image: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading-shimmer 1.5s infinite;
    transition: opacity 0.3s ease;
}

.lazy-loaded {
    opacity: 1;
    background: none;
    animation: none;
    transition: opacity 0.3s ease;
}

.lazy-error {
    opacity: 0.8;
    background-color: #fee2e2;
    border: 2px dashed #fca5a5;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #dc2626;
    font-size: 14px;
    text-align: center;
}

.lazy-error::after {
    content: "Image not available";
    padding: 20px;
}

@keyframes loading-shimmer {
    0% {
        background-position: -200% 0;
    }
    100% {
        background-position: 200% 0;
    }
}

/* Image Optimization */
img {
    /* Optimize image rendering */
    image-rendering: -webkit-optimize-contrast;
    image-rendering: optimize-contrast;
    
    /* Prevent layout shift */
    height: auto;
    max-width: 100%;
}

/* WebP Support Detection */
.webp img[data-src] {
    /* WebP images load faster */
    transition: opacity 0.2s ease;
}

.no-webp img[data-src] {
    /* Fallback for browsers without WebP support */
    transition: opacity 0.3s ease;
}

/* Critical Resource Loading States */
.critical-css-loading {
    /* Hide content until critical CSS loads */
    visibility: hidden;
}

.critical-css-loaded {
    visibility: visible;
    animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Performance Dashboard (Development Only) */
#performance-dashboard {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.9);
    color: #00ff00;
    padding: 15px;
    border-radius: 8px;
    font-family: 'Courier New', monospace;
    font-size: 11px;
    z-index: 10000;
    max-width: 320px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    border: 1px solid #333;
}

#performance-dashboard h4 {
    color: #00ffff;
    margin-bottom: 8px;
    font-size: 12px;
    border-bottom: 1px solid #333;
    padding-bottom: 4px;
}

#performance-dashboard div {
    margin: 4px 0;
    display: flex;
    justify-content: space-between;
}

#performance-dashboard .metric-good {
    color: #00ff00;
}

#performance-dashboard .metric-warning {
    color: #ffff00;
}

#performance-dashboard .metric-poor {
    color: #ff0000;
}

/* Resource Optimization Indicators */
.resource-optimized::after {
    content: "âœ“";
    color: #10b981;
    font-weight: bold;
    margin-left: 4px;
}

.resource-error::after {
    content: "âœ—";
    color: #ef4444;
    font-weight: bold;
    margin-left: 4px;
}

/* Preload Hints */
link[rel="preload"] {
    /* Ensure preload links don't interfere with layout */
    display: none;
}

/* Critical Above-the-Fold Optimizations */
.hero-section {
    /* Optimize hero section rendering */
    contain: layout style paint;
    will-change: transform;
}

.hero-image {
    /* Optimize hero image */
    contain: layout style paint;
    transform: translateZ(0); /* Force hardware acceleration */
}

/* Intersection Observer Optimizations */
.intersection-observer-root {
    /* Optimize intersection observer performance */
    contain: layout style paint;
}

/* Font Loading Optimizations */
@font-face {
    font-family: 'FontAwesome';
    font-display: swap; /* Prevent invisible text during font load */
    src: url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/webfonts/fa-solid-900.woff2') format('woff2');
}

/* Reduce Motion for Performance */
@media (prefers-reduced-motion: reduce) {
    .lazy-loading {
        animation: none;
    }
    
    .lazy-loaded {
        transition: none;
    }
    
    #performance-dashboard {
        animation: none;
        transition: none;
    }
}

/* High Performance Mode */
@media (prefers-reduced-data: reduce) {
    /* Disable animations and transitions to save bandwidth */
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
    
    .lazy-loading {
        background-image: none;
        animation: none;
    }
}

/* Memory Optimization */
.memory-optimized {
    /* Optimize memory usage for large images */
    content-visibility: auto;
    contain-intrinsic-size: 300px 200px;
}

/* GPU Acceleration for Performance */
.gpu-accelerated {
    transform: translateZ(0);
    will-change: transform, opacity;
    backface-visibility: hidden;
}

/* Efficient Scrolling */
.scroll-optimized {
    /* Optimize scroll performance */
    overflow-anchor: none;
    overscroll-behavior: contain;
}

/* Resource Loading States */
.resource-loading {
    position: relative;
}

.resource-loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 20px;
    height: 20px;
    border: 2px solid #e5e7eb;
    border-top: 2px solid #3b82f6;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: translate(-50%, -50%) rotate(0deg); }
    100% { transform: translate(-50%, -50%) rotate(360deg); }
}

/* Performance Metrics Display */
.performance-metrics {
    font-family: monospace;
    font-size: 12px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 10px;
    border-radius: 4px;
    position: fixed;
    bottom: 10px;
    left: 10px;
    z-index: 9999;
}

.performance-metrics.hidden {
    display: none;
}

/* Optimize Third-party Content */
iframe {
    /* Optimize iframe performance - loading and importance are HTML attributes, not CSS properties */
    /* Use loading="lazy" and importance="low" as HTML attributes instead */
    contain: layout style paint;
}

/* Critical CSS Inlined Indicator */
.critical-css-inlined {
    /* Visual indicator that critical CSS is inlined */
    --critical-css: true;
}

/* Non-critical CSS Loading */
.non-critical-css-loading {
    /* Prevent FOUC while non-critical CSS loads */
    opacity: 0.95;
}

.non-critical-css-loaded {
    opacity: 1;
    transition: opacity 0.2s ease;
}

/* Responsive Image Optimization */
picture {
    /* Optimize picture element performance */
    display: block;
    contain: layout style;
}

picture img {
    width: 100%;
    height: auto;
    object-fit: cover;
}

/* Service Worker Cache Indicators */
.cached-resource {
    /* Visual indicator for cached resources */
    position: relative;
}

.cached-resource::before {
    content: "ðŸ“¦";
    position: absolute;
    top: -5px;
    right: -5px;
    font-size: 12px;
    opacity: 0.7;
}

/* Performance Budget Warnings */
.performance-budget-exceeded {
    /* Warning for resources exceeding performance budget */
    border: 2px solid #ef4444 !important;
    background-color: rgba(239, 68, 68, 0.1) !important;
}

/* Efficient Event Handling */
.passive-scroll {
    /* Optimize scroll event handling */
    touch-action: pan-y;
    overscroll-behavior-y: contain;
}

/* Layout Stability */
.layout-stable {
    /* Prevent layout shifts */
    contain: layout style paint;
    content-visibility: auto;
}

/* Print Optimizations */
@media print {
    #performance-dashboard,
    .performance-metrics {
        display: none !important;
    }
    
    .lazy-loading,
    .lazy-loaded {
        background: none !important;
        animation: none !important;
    }
}